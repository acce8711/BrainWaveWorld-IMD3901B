AFRAME.registerComponent("lights-interactive",{schema:{},init(){const t=this,i=CIRCLES.getCirclesSceneElement();if(t.light_1=i.querySelector("#light_1"),t.light_2=i.querySelector("#light_2"),t.light_3=i.querySelector("#light_3"),t.light_4=i.querySelector("#light_4"),t.light_1.lightOn=!1,t.light_2.lightOn=!1,t.light_3.lightOn=!1,t.light_4.lightOn=!1,t.socket=null,t.connected=!1,t.synchEventName="lights_event",t.createNetworkingSystem=function(){t.socket=CIRCLES.getCirclesWebsocket(),t.connected=!0,console.warn("messaging system connected at socket: "+t.socket.id+" in room:"+CIRCLES.getCirclesGroupName()+" in world:"+CIRCLES.getCirclesWorldName()),t.light_1.addEventListener("click",(function(){t.toggleLight(t.light_1,!1),t.socket.emit(t.synchEventName,{light_1_on:t.light_1.lightOn,light_2_on:t.light_2.lightOn,light_3_on:t.light_3.lightOn,light_4_on:t.light_4.lightOn,room:CIRCLES.getCirclesGroupName(),world:CIRCLES.getCirclesWorldName()})})),t.light_2.addEventListener("click",(function(){t.toggleLight(t.light_2,!1),t.socket.emit(t.synchEventName,{light_1_on:t.light_1.lightOn,light_2_on:t.light_2.lightOn,light_3_on:t.light_3.lightOn,light_4_on:t.light_4.lightOn,room:CIRCLES.getCirclesGroupName(),world:CIRCLES.getCirclesWorldName()})})),t.light_3.addEventListener("click",(function(){t.toggleLight(t.light_3,!1),t.socket.emit(t.synchEventName,{light_1_on:t.light_1.lightOn,light_2_on:t.light_2.lightOn,light_3_on:t.light_3.lightOn,light_4_on:t.light_4.lightOn,room:CIRCLES.getCirclesGroupName(),world:CIRCLES.getCirclesWorldName()})})),t.light_4.addEventListener("click",(function(){t.toggleLight(t.light_4,!1),t.socket.emit(t.synchEventName,{light_1_on:t.light_1.lightOn,light_2_on:t.light_2.lightOn,light_3_on:t.light_3.lightOn,light_4_on:t.light_4.lightOn,room:CIRCLES.getCirclesGroupName(),world:CIRCLES.getCirclesWorldName()})})),t.socket.on(t.synchEventName,(function(i){t.light_1.lightOn!==i.light_1_on&&t.toggleLight(t.light_1,!0),t.light_2.lightOn!==i.light_2_on&&t.toggleLight(t.light_2,!0),t.light_3.lightOn!==i.light_3_on&&t.toggleLight(t.light_3,!0),t.light_4.lightOn!==i.light_4_on&&t.toggleLight(t.light_4,!0)})),setTimeout((function(){t.socket.emit(CIRCLES.EVENTS.REQUEST_DATA_SYNC,{room:CIRCLES.getCirclesGroupName(),world:CIRCLES.getCirclesWorldName()})}),THREE.MathUtils.randInt(0,1200)),t.socket.on(CIRCLES.EVENTS.REQUEST_DATA_SYNC,(function(i){i.world===CIRCLES.getCirclesWorldName()&&t.socket.emit(CIRCLES.EVENTS.SEND_DATA_SYNC,{light_1_on:t.light_1.lightOn,light_2_on:t.light_2.lightOn,light_3_on:t.light_3.lightOn,light_4_on:t.light_4.lightOn,room:CIRCLES.getCirclesGroupName(),world:CIRCLES.getCirclesWorldName()})})),t.socket.on(CIRCLES.EVENTS.RECEIVE_DATA_SYNC,(function(i){i.world===CIRCLES.getCirclesWorldName()&&(t.light_1.lightOn!==i.light_1_on&&t.toggleLight(t.light_1,!1),t.light_2.lightOn!==i.light_2_on&&t.toggleLight(t.light_2,!1),t.light_3.lightOn!==i.light_3_on&&t.toggleLight(t.light_3,!1),t.light_4.lightOn!==i.light_4_on&&t.toggleLight(t.light_4,!1))}))},i.addEventListener(CIRCLES.EVENTS.READY,(function(){console.log("Circles is ready: "+CIRCLES.isReady()),console.log("Circles camera ID: "+CIRCLES.getMainCameraElement().id)})),CIRCLES.isCirclesWebsocketReady())t.createNetworkingSystem();else{const i=function(){t.createNetworkingSystem(),t.el.sceneEl.removeEventListener(CIRCLES.EVENTS.WS_CONNECTED,i)};t.el.sceneEl.addEventListener(CIRCLES.EVENTS.WS_CONNECTED,i)}},update(){},toggleLight:function(t,i){t.lightOn=!t.lightOn;let e=t.lightOn?6:0,l=t.lightOn?15:5;t.setAttribute("material",{emissiveIntensity:e}),t.querySelector("[light]").setAttribute("light",{intensity:l}),t.components["circles-interactive-object"].sound&&!0===i&&(t.components["circles-interactive-object"].sound.stopSound(),t.components["circles-interactive-object"].sound.playSound())}});